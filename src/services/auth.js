const a0_0x414ebd=a0_0x3ab6;(function(_0x41f586,_0x238603){const _0x4591f0=a0_0x3ab6,_0x6fdbd=_0x41f586();while(!![]){try{const _0x38d814=parseInt(_0x4591f0(0xb8))/0x1*(-parseInt(_0x4591f0(0x7f))/0x2)+-parseInt(_0x4591f0(0x88))/0x3*(-parseInt(_0x4591f0(0x8c))/0x4)+parseInt(_0x4591f0(0xa2))/0x5+parseInt(_0x4591f0(0xc6))/0x6+parseInt(_0x4591f0(0xbb))/0x7*(parseInt(_0x4591f0(0xa8))/0x8)+-parseInt(_0x4591f0(0xaf))/0x9*(parseInt(_0x4591f0(0xc0))/0xa)+-parseInt(_0x4591f0(0x82))/0xb;if(_0x38d814===_0x238603)break;else _0x6fdbd['push'](_0x6fdbd['shift']());}catch(_0x1e81e0){_0x6fdbd['push'](_0x6fdbd['shift']());}}}(a0_0x262d,0x5b854));const a0_0x586688=(function(){let _0x4ac3b8=!![];return function(_0x4600b3,_0x4090ae){const _0x44c4a7=_0x4ac3b8?function(){if(_0x4090ae){const _0x4db1a2=_0x4090ae['apply'](_0x4600b3,arguments);return _0x4090ae=null,_0x4db1a2;}}:function(){};return _0x4ac3b8=![],_0x44c4a7;};}());(function(){a0_0x586688(this,function(){const _0xd1e214=a0_0x3ab6,_0x1ec65f=new RegExp('function\x20*\x5c(\x20*\x5c)'),_0x449890=new RegExp(_0xd1e214(0x9b),'i'),_0x338707=a0_0x5794c3(_0xd1e214(0xb6));!_0x1ec65f['test'](_0x338707+_0xd1e214(0x9c))||!_0x449890[_0xd1e214(0x94)](_0x338707+_0xd1e214(0xae))?_0x338707('0'):a0_0x5794c3();})();}());import{ethers}from'ethers';import{createApiClient}from'../core/api.js';import{getAccount,saveAccount,isRegistered,sleep}from'../utils/helper.js';function a0_0x3ab6(_0x6136d7,_0x5b9362){_0x6136d7=_0x6136d7-0x72;const _0x53c463=a0_0x262d();let _0x5794c3=_0x53c463[_0x6136d7];return _0x5794c3;}import a0_0x1b097e from'../../config.js';const REF=a0_0x1b097e?.[a0_0x414ebd(0xb0)]||a0_0x414ebd(0x95),_BASE_URL=a0_0x1b097e?.[a0_0x414ebd(0x98)]||a0_0x414ebd(0x9d),WEBSITE_ID=a0_0x1b097e?.[a0_0x414ebd(0xa6)]||a0_0x414ebd(0xb3),ORGANIZATION_ID=a0_0x1b097e?.[a0_0x414ebd(0xc3)]||a0_0x414ebd(0xc4);function buildSiweMessage(_0x399487,_0x1ac34d){const _0x2b3207=a0_0x414ebd;return{'domain':'quest.quip.network','address':_0x399487,'statement':'Sign\x20in\x20to\x20the\x20app.\x20Powered\x20by\x20Snag\x20Solutions.','uri':'https://quest.quip.network','version':'1','chainId':0xaa36a7,'nonce':_0x1ac34d,'issuedAt':new Date()[_0x2b3207(0x73)]()};}function a0_0x262d(){const _0x322316=['URI:\x20','substring','nonce','input','2763HQNpJn','REF','\x20wants\x20you\x20to\x20sign\x20in\x20with\x20your\x20Ethereum\x20account:','signMessage','5b807696-bd6b-4c6c-b169-6982aa7fd7ad','stateObject','Getting\x20CSRF\x20token...','init','UserId:\x20','10neloaV','Visiting\x20airdrop\x20page\x20(','debu','7MebchQ','domain','SIWE\x20EIP-4361\x20text:\x0a','info','Signing\x20SIWE\x20message...','15530HBHZrG','success','call','ORGANIZATION_ID','8493fc88-5e71-41b2-9156-07f6561687ae','CSRF\x20token:\x20','3126120cnODoF','join','version','Fetching\x20user\x20metadata...','toISOString','address','login',')...','Login\x20payload:\x20message=','map','issuedAt','visitAirdropPage','message','uri','sessionToken','debug','118130NZqMxj','string','constructor','3221922wvwWkN','stringify','Failed\x20to\x20get\x20CSRF\x20token','Could\x20not\x20extract\x20userId\x20from\x20metadata','Signature:\x20','registered','15BuWqvj','Version:\x20',',\x20csrfToken=',',\x20walletAddress=','556432HOwnnC','length','Chain\x20ID:\x20','Auth\x20failed:\x20','Logging\x20in...','cookieJar','Nonce:\x20','getCookies','test','VU9Q3IBM','gger','Cookies\x20after\x20login:\x20','BASE_URL','new\x20account','apply','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','chain','https://quest.quip.network','chainId','random','Session\x20token:\x20','...','1496680DeaYtk','Login\x20failed\x20-\x20no\x20session\x20token\x20received','value','action','WEBSITE_ID','Login\x20result:\x20','1754360mlaEHQ','error','SIWE\x20message\x20object:\x20'];a0_0x262d=function(){return _0x322316;};return a0_0x262d();}function toEip4361(_0x1822b9){const _0x4b5ce8=a0_0x414ebd,_0x233460=[_0x1822b9[_0x4b5ce8(0xbc)]+_0x4b5ce8(0xb1),_0x1822b9[_0x4b5ce8(0x74)],'',_0x1822b9['statement'],'',_0x4b5ce8(0xab)+_0x1822b9[_0x4b5ce8(0x7c)],_0x4b5ce8(0x89)+_0x1822b9[_0x4b5ce8(0xc8)],_0x4b5ce8(0x8e)+_0x1822b9[_0x4b5ce8(0x9e)],_0x4b5ce8(0x92)+_0x1822b9[_0x4b5ce8(0xad)],'Issued\x20At:\x20'+_0x1822b9[_0x4b5ce8(0x79)]];return _0x233460[_0x4b5ce8(0xc7)]('\x0a');}export async function login(_0x505ee2,_0x2232be=null,_0x133b61=0x1,_0x650651=null){const _0x599ad2=a0_0x414ebd,_0x4c0dc7=_0x505ee2[_0x599ad2(0x74)],_0x34e1a5={'info':()=>{},'success':()=>{},'warn':()=>{},'error':()=>{},'debug':()=>{}};_0x650651=_0x650651||_0x34e1a5;const _0x57d10a=createApiClient(_0x2232be,_0x4c0dc7,_0x650651),_0x55c9f7=!isRegistered(_0x4c0dc7);try{_0x650651[_0x599ad2(0xbe)](_0x599ad2(0xb9)+(_0x55c9f7?_0x599ad2(0x99):_0x599ad2(0x87))+_0x599ad2(0x76)),await _0x57d10a[_0x599ad2(0x7a)](_0x55c9f7,REF),await sleep(0x3e8+Math[_0x599ad2(0x9f)]()*0x7d0),_0x650651[_0x599ad2(0xbe)](_0x599ad2(0xb5));const _0x503943=await _0x57d10a['getCsrfToken']();if(!_0x503943)throw new Error(_0x599ad2(0x84));_0x650651['debug'](_0x599ad2(0xc5)+_0x503943['substring'](0x0,0xa)+_0x599ad2(0xa1));const _0x47513b=buildSiweMessage(_0x4c0dc7,_0x503943),_0x1d6b81=toEip4361(_0x47513b);_0x650651[_0x599ad2(0x7e)](_0x599ad2(0xaa)+JSON[_0x599ad2(0x83)](_0x47513b)),_0x650651[_0x599ad2(0x7e)](_0x599ad2(0xbd)+_0x1d6b81),_0x650651[_0x599ad2(0xbe)](_0x599ad2(0xbf));const _0x28130f=await _0x505ee2[_0x599ad2(0xb2)](_0x1d6b81);_0x650651[_0x599ad2(0x7e)](_0x599ad2(0x86)+_0x28130f),_0x650651[_0x599ad2(0xbe)](_0x599ad2(0x90)),_0x650651[_0x599ad2(0x7e)](_0x599ad2(0x77)+JSON[_0x599ad2(0x83)](_0x47513b)+_0x599ad2(0x8b)+_0x4c0dc7+_0x599ad2(0x8a)+_0x503943);const _0x3c2396=await _0x57d10a[_0x599ad2(0x75)](_0x47513b,_0x28130f,_0x4c0dc7,_0x503943);if(!_0x3c2396[_0x599ad2(0xc1)]){_0x650651[_0x599ad2(0x7e)](_0x599ad2(0xa7)+JSON['stringify'](_0x3c2396));try{const _0x23a887=await _0x57d10a[_0x599ad2(0x91)][_0x599ad2(0x93)](_BASE_URL);_0x650651[_0x599ad2(0x7e)](_0x599ad2(0x97)+_0x23a887[_0x599ad2(0x78)](_0x47d098=>_0x47d098['key']+'='+_0x47d098[_0x599ad2(0xa4)]?.[_0x599ad2(0xac)](0x0,0x1e)+_0x599ad2(0xa1))[_0x599ad2(0xc7)](';\x20'));}catch{}throw new Error(_0x599ad2(0xa3));}_0x650651['success']('Login\x20successful!'),_0x650651[_0x599ad2(0x7e)](_0x599ad2(0xa0)+_0x3c2396[_0x599ad2(0x7d)]?.['substring'](0x0,0x1e)+_0x599ad2(0xa1)),_0x650651[_0x599ad2(0xbe)](_0x599ad2(0x72)),await sleep(0x3e8+Math[_0x599ad2(0x9f)]()*0x3e8);const _0x3254d5=await _0x57d10a['getUserMetadata'](WEBSITE_ID,ORGANIZATION_ID,_0x4c0dc7['toLowerCase']()),_0x48965c=_0x3254d5?.['data']?.[0x0]?.['user']?.['id'];return!_0x48965c?_0x650651['warn'](_0x599ad2(0x85)):_0x650651[_0x599ad2(0xc1)](_0x599ad2(0xb7)+_0x48965c),saveAccount({'wallet':_0x4c0dc7,'registered':!![],'userId':_0x48965c||null,'sessionToken':_0x3c2396[_0x599ad2(0x7d)],'lastLogin':new Date()[_0x599ad2(0x73)]()}),{'success':!![],'userId':_0x48965c,'sessionToken':_0x3c2396[_0x599ad2(0x7d)],'api':_0x57d10a};}catch(_0x4f4ca3){return _0x650651[_0x599ad2(0xa9)](_0x599ad2(0x8f)+_0x4f4ca3[_0x599ad2(0x7b)]),{'success':![],'error':_0x4f4ca3[_0x599ad2(0x7b)],'api':null};}}function a0_0x5794c3(_0x4f36ee){function _0x5de6e2(_0x51cab3){const _0x5e0d5f=a0_0x3ab6;if(typeof _0x51cab3===_0x5e0d5f(0x80))return function(_0x6715ec){}[_0x5e0d5f(0x81)]('while\x20(true)\x20{}')[_0x5e0d5f(0x9a)]('counter');else(''+_0x51cab3/_0x51cab3)[_0x5e0d5f(0x8d)]!==0x1||_0x51cab3%0x14===0x0?function(){return!![];}['constructor'](_0x5e0d5f(0xba)+_0x5e0d5f(0x96))[_0x5e0d5f(0xc2)](_0x5e0d5f(0xa5)):function(){return![];}[_0x5e0d5f(0x81)](_0x5e0d5f(0xba)+_0x5e0d5f(0x96))[_0x5e0d5f(0x9a)](_0x5e0d5f(0xb4));_0x5de6e2(++_0x51cab3);}try{if(_0x4f36ee)return _0x5de6e2;else _0x5de6e2(0x0);}catch(_0xaeb8dc){}}